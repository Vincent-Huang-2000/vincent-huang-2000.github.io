<!DOCTYPE html>
<html lang="zh-CN,en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/v/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/v/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/v/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="本文主要列出了一些 Apache Spark 的函数的使用，配上了具体的代码示例，更方便初学者的使用（我自己就是初学者hh）">
<meta property="og:type" content="article">
<meta property="og:title" content="Spark基础函数指南(python版)">
<meta property="og:url" content="http://example.com/2023/03/12093ec9a984/index.html">
<meta property="og:site_name" content="Vincent&#39;s Blog">
<meta property="og:description" content="本文主要列出了一些 Apache Spark 的函数的使用，配上了具体的代码示例，更方便初学者的使用（我自己就是初学者hh）">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-03-01T02:21:43.000Z">
<meta property="article:modified_time" content="2023-03-04T11:01:03.948Z">
<meta property="article:author" content="Vincent Huang">
<meta property="article:tag" content="Apache Spark">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2023/03/12093ec9a984/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Spark基础函数指南(python版) | Vincent's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Vincent's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/12093ec9a984/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vincent Huang">
      <meta itemprop="description" content="A student studying in New Zealand, majoring in computer science.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vincent's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Spark基础函数指南(python版)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-01 15:21:43" itemprop="dateCreated datePublished" datetime="2023-03-01T15:21:43+13:00">2023-03-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-05 00:01:03" itemprop="dateModified" datetime="2023-03-05T00:01:03+13:00">2023-03-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              <span>7.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>本文主要列出了一些 Apache Spark 的函数的使用，配上了具体的代码示例，更方便初学者的使用（我自己就是初学者hh）</p>
<a id="more"></a>
<h2 id="rdd转换操作rdd-transformation">RDD转换操作（RDD Transformation）</h2>
<p>Spark 转换操作是一个从现有的 RDD 生成新 RDD 的函数。它以 RDD 作为输入参数，生成并输出一个或多个RDD。每当我们使用任何一个转换操作函数的时候，它都会生成新的 RDD。由于 RDD 本质上是不可变的，因此输入的 RDD 也是不可变的。</p>
<p>转换操作本质上是一种懒加载，也就是说不会立即执行转换函数，只有当我们调用执行操作函数的时候才会执行转换操作函数。转换操作最基本最常用的两个函数是：map() 和 fliter() 函数。转换后生成的 RDD 始终与其父 RDD 不同。转换后的RDD 可能变得比小（如：filter(), count(), distinct(), sample()），也可能比大（如：flatMap(), union(), Cartesian()）甚至大小一样的（如：map()）。</p>
<h3 id="mapfunc">map(func)</h3>
<p>map(func) 函数遍历 RDD 中的每一行并拆分为新的 RDD。使用接受任何函数作为输入参数的 map() 函数，并且该函数（入参函数）作用到 RDD 的每个元素上面。</p>
<p>在 map() 函数中，我们可以灵活地选择 RDD 的输入和返回类型。例如，我们可以将字符串作为RDD的输入类型，在应用map() 函数之后，返回的 RDD 可以是布尔类型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub</span>(<span class="params">value</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (value - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要转换成 RDD</span></span><br><span class="line">rangeRDD = sc.parallelize(data, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">subRDD = rangeRDD.<span class="built_in">map</span>(sub)</span><br><span class="line"></span><br><span class="line">print(subRDD.collect())</span><br></pre></td></tr></table></figure>
<p>注意，如果数据量很大的情况下，直接调用 <code>collect()</code> 会造成一些问题，所以再这之前可以调用譬如 <code>filter</code> 等函数，来缩小要显示的数据量。而<code>collect()</code> 也是一个 action operations，这意味着从这里 Spark 才开始执行计算的操作。</p>
<h3 id="flatmap">flatMap()</h3>
<p>通过首先将一个函数应用于此 RDD 的所有元素，然后展平结果来返回一个新的 RDD。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>(rdd.flatMap(<span class="keyword">lambda</span> x: <span class="built_in">range</span>(<span class="number">1</span>, x)).collect())</span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>(rdd.flatMap(<span class="keyword">lambda</span> x: [(x, x), (x, x)]).collect())</span><br><span class="line">[(<span class="number">2</span>, <span class="number">2</span>), (<span class="number">2</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">3</span>), (<span class="number">3</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">4</span>), (<span class="number">4</span>, <span class="number">4</span>)]</span><br></pre></td></tr></table></figure>
<p>跟 <code>map()</code> 的区别：https://blog.csdn.net/CYJ2014go/article/details/83014075</p>
<p>再举例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Let&#x27;s create a new base RDD to work from</span></span><br><span class="line">wordsList = [<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;elephant&#x27;</span>, <span class="string">&#x27;rat&#x27;</span>, <span class="string">&#x27;rat&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>]</span><br><span class="line">wordsRDD = sc.parallelize(wordsList, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use map</span></span><br><span class="line">singularAndPluralWordsRDDMap = wordsRDD.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: (x, x + <span class="string">&#x27;s&#x27;</span>))</span><br><span class="line"><span class="comment"># Use flatMap</span></span><br><span class="line">singularAndPluralWordsRDD = wordsRDD.flatMap(<span class="keyword">lambda</span> x: (x, x + <span class="string">&#x27;s&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># View the results</span></span><br><span class="line">print(singularAndPluralWordsRDDMap.collect())</span><br><span class="line">print(singularAndPluralWordsRDD.collect())</span><br><span class="line"><span class="comment"># View the number of elements in the RDD</span></span><br><span class="line">print(singularAndPluralWordsRDDMap.count())</span><br><span class="line">print(singularAndPluralWordsRDD.count())</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[(&#39;cat&#39;, &#39;cats&#39;), (&#39;elephant&#39;, &#39;elephants&#39;), (&#39;rat&#39;, &#39;rats&#39;), (&#39;rat&#39;, &#39;rats&#39;), (&#39;cat&#39;, &#39;cats&#39;)]</span><br><span class="line">[&#39;cat&#39;, &#39;cats&#39;, &#39;elephant&#39;, &#39;elephants&#39;, &#39;rat&#39;, &#39;rats&#39;, &#39;rat&#39;, &#39;rats&#39;, &#39;cat&#39;, &#39;cats&#39;]</span><br><span class="line">5</span><br><span class="line">10</span><br></pre></td></tr></table></figure>
<p>再举例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">simpleRDD = sc.parallelize([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">print(simpleRDD.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">range</span>(<span class="number">1</span>, x)).collect())</span><br><span class="line">print(simpleRDD.flatMap(<span class="keyword">lambda</span> x: <span class="built_in">range</span>(<span class="number">1</span>, x)).collect())</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[range(1, 2), range(1, 3), range(1, 4)]</span><br><span class="line">[1, 1, 2, 1, 2, 3]</span><br></pre></td></tr></table></figure>
<h3 id="filterfunc">filter(func)</h3>
<p>Spark RDD filter() 函数返回一个新的 RDD，其中仅包含满足谓词的元素。这是一个窄转换操作，因为它不会把数据从一个分区映射到多个分区。例如，假设 RDD 包含前五个自然数（1、2、3、4和5），并且谓词检查偶数。那么过滤器后的结果 RDD 中就只包含偶数，即2和4。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ten</span>(<span class="params">value</span>):</span></span><br><span class="line">    <span class="keyword">if</span> (value &lt; <span class="number">10</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">data = <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">subRDD = sc.parallelize(data, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">filteredRDD = subRDD.<span class="built_in">filter</span>(ten)</span><br><span class="line"></span><br><span class="line">print(filteredRDD.collect())</span><br></pre></td></tr></table></figure>
<p>同样可以用 Python 的 <code>lambda</code> 表达式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lambdaRDD = subRDD.<span class="built_in">filter</span>(<span class="keyword">lambda</span> x: x &lt; <span class="number">10</span>)</span><br><span class="line">lambdaRDD.collect()</span><br></pre></td></tr></table></figure>
<h3 id="groupbykey">groupByKey()</h3>
<p>将 RDD 中每个键的值分组为一个序列。使用 numPartitions 分区对生成的 RDD 进行哈希分区。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>), (<span class="string">&quot;b&quot;</span>, <span class="number">1</span>), (<span class="string">&quot;a&quot;</span>, <span class="number">1</span>)])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>(rdd.groupByKey().mapValues(<span class="built_in">len</span>).collect())</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>(rdd.groupByKey().mapValues(<span class="built_in">list</span>).collect())</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, [<span class="number">1</span>, <span class="number">1</span>]), (<span class="string">&#x27;b&#x27;</span>, [<span class="number">1</span>])]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pairRDD = sc.parallelize([(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>)])</span><br><span class="line"><span class="comment"># mapValues only used to improve format for printing</span></span><br><span class="line">print(pairRDD.groupByKey().mapValues(<span class="keyword">lambda</span> x: <span class="built_in">list</span>(x)).collect())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Different ways to sum by key</span></span><br><span class="line">print(pairRDD.groupByKey().<span class="built_in">map</span>(<span class="keyword">lambda</span> kv: (kv[<span class="number">0</span>], <span class="built_in">sum</span>(kv[<span class="number">1</span>]))).collect())</span><br><span class="line"><span class="comment"># Using mapValues, which is recommended when they key doesn&#x27;t change</span></span><br><span class="line">print(pairRDD.groupByKey().mapValues(<span class="keyword">lambda</span> x: <span class="built_in">sum</span>(x)).collect())</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[(&#39;b&#39;, [1]), (&#39;a&#39;, [1, 2])]</span><br><span class="line">[(&#39;b&#39;, 1), (&#39;a&#39;, 3)]</span><br><span class="line">[(&#39;b&#39;, 1), (&#39;a&#39;, 3)]</span><br></pre></td></tr></table></figure>
<h3 id="reducebykey">reduceByKey()</h3>
<p>使用关联和可交换的 reduce 函数合并每个键的值。 这还将在将结果发送到 reducer 之前在每个映射器上执行本地合并，类似于 MapReduce 中的“组合器”。 输出将使用 numPartitions 分区进行分区，如果未指定 numPartitions，则使用默认并行级别。默认分区程序是散列分区。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> operator <span class="keyword">import</span> add</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rdd = sc.parallelize([(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>), (<span class="string">&quot;b&quot;</span>, <span class="number">1</span>), (<span class="string">&quot;a&quot;</span>, <span class="number">1</span>)])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>(rdd.reduceByKey(add).collect())</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>)]</span><br></pre></td></tr></table></figure>
<p>reduceByKey() 将具有相同键的对聚集在一起，并一次将一个函数应用于两个关联的值。 reduceByKey() 通过首先在每个分区内基于每个键然后跨分区应用该函数来运行。</p>
<p>虽然 groupByKey() 和 reduceByKey() 转换通常可用于解决相同的问题并产生相同的答案，但 reduceByKey() 转换对于大型分布式数据集的效果要好得多。这是因为 Spark 知道它可以在跨节点洗牌（重新分配）数据<strong>之前</strong>将输出与每个分区上的公共密钥结合起来。只有在随机播放发生之前操作不会从减少数据中获益时才使用 groupByKey()。</p>
<h3 id="combinebykey">combineByKey()</h3>
<p>组合元素时可以使用 combineByKey() 但返回类型与输入值类型不同。</p>
<p>https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.RDD.combineByKey.html?highlight=combinebykey#pyspark.RDD.combineByKey</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x = sc.parallelize([(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>), (<span class="string">&quot;b&quot;</span>, <span class="number">1</span>), (<span class="string">&quot;a&quot;</span>, <span class="number">2</span>)])</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_list</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [a]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">append</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    a.append(b)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extend</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    a.extend(b)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="built_in">sorted</span>(x.combineByKey(to_list, append, extend).collect())</span><br><span class="line"><span class="comment"># [(&#x27;a&#x27;, [1, 2]), (&#x27;b&#x27;, [1])]</span></span><br></pre></td></tr></table></figure>
<h3 id="foldbykey">foldByKey()</h3>
<p>foldByKey() 使用关联函数和中性“零值”合并每个键的值。</p>
<h2 id="rdd执行操作rdd-action">RDD执行操作（RDD Action）</h2>
<p>转换操作函数从一个RDD转换成另一个 RDD，但当我们处理实际的数据集时会调用执行函数进行数据的处理。在结果之后触发执行操作函数时，不会像转换操作函数那样生成新的RDD。因此，执行操作函数是提供非RDD值的Spark RDD操作。</p>
<p>执行函数生成的值将被存储到驱动程序或外部存储系统中。因此形成了RDD的惰性特性。执行操作函数是从执行器向驱动程序发送数据的方法之一，执行器代理执行操作任务；而驱动程序是一个协调工作人员和任务执行的JVM进程。Spark的部分执行函数有如下这些：</p>
<h3 id="count-返回-rdd-中的元素数量">count() 返回 RDD 中的元素数量</h3>
<h3 id="taken">take(n)</h3>
<p>返回 RDD 的前 num 个元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc.parallelize([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]).take(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<h3 id="first">first()</h3>
<p>first() 操作返回 RDD 的第一个元素，等同于 <code>take(1)</code></p>
<h3 id="takeordered">takeOrdered()</h3>
<p>从按升序排列或按可选键函数指定的顺序排列的 RDD 中获取 N 个元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sc.parallelize([<span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]).takeOrdered(<span class="number">6</span>)</span><br><span class="line"><span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br><span class="line">sc.parallelize([<span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>], <span class="number">2</span>).takeOrdered(<span class="number">6</span>, key=<span class="keyword">lambda</span> x: -x)</span><br><span class="line"><span class="comment"># [10, 9, 7, 6, 5, 4]</span></span><br></pre></td></tr></table></figure>
<p>使用 takeOrdered() 而不是 first() 或 take() 的主要优点是 takeOrdered() 返回确定性结果，而其他两个操作可能返回不同的结果，具体取决于分区数或执行环境。</p>
<p>takeOrdered() 返回按升序排序的列表。 top() 操作与 takeOrdered() 类似，只是它按降序返回列表。</p>
<p>上面可以使用 <code>key=lambda x: -x</code> 实现倒叙，实际上有更加高级一点的用法。如下例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tempData = sc.parallelize([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line">tempData1 = tempData.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: (x, <span class="number">1</span>))</span><br><span class="line">tempData2 = tempData1.reduceByKey(<span class="keyword">lambda</span> a,b: a+b)</span><br><span class="line">res = tempData2.takeOrdered(<span class="number">1</span>, key=<span class="keyword">lambda</span> x: -x[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">print(tempData1.collect())</span><br><span class="line">print(tempData2.collect())</span><br><span class="line">print(res)</span><br><span class="line"><span class="comment"># [(&#x27;a&#x27;, 1), (&#x27;b&#x27;, 1), (&#x27;c&#x27;, 1), (&#x27;c&#x27;, 1), (&#x27;c&#x27;, 1)]</span></span><br><span class="line"><span class="comment"># [(&#x27;b&#x27;, 1), (&#x27;c&#x27;, 3), (&#x27;a&#x27;, 1)]</span></span><br><span class="line"><span class="comment"># [(&#x27;c&#x27;, 3)]</span></span><br></pre></td></tr></table></figure>
<p><code>takeOrdered()</code> 这个函数里 <code>key</code> 接受的 lambda 表达式带的参数只允许有一个，而上例的 <code>x</code> 相当于 <code>[('b', 1), ('c', 3), ('a', 1)]</code> 的每一个元素（如 <code>('b', 1)</code>），<code>lambda x: -x[1]</code> 所做的即是依据 <code>('b', 1)</code> 的第二个元素作为排序。</p>
<h3 id="top">top()</h3>
<p>从 RDD 中获取前 N 个元素。（即降序）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sc.parallelize([<span class="number">10</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">3</span>]).top(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># [12]</span></span><br><span class="line">sc.parallelize([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="number">2</span>).top(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># [6, 5]</span></span><br><span class="line">sc.parallelize([<span class="number">10</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">3</span>]).top(<span class="number">3</span>, key=<span class="built_in">str</span>)</span><br><span class="line"><span class="comment"># [4, 3, 2]</span></span><br></pre></td></tr></table></figure>
<h3 id="reduce">reduce()</h3>
<p>reduce() 函数从 RDD 中取两个元素作为输入参数，然后输出与输入元素类型相同的结果。我们可以往 RDD 中添加元素，然后统计单词数量。它接受交换与结合运算作为参数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> add</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sc.parallelize([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]).reduce(add)</span><br><span class="line"><span class="number">15</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sc.parallelize((<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>))).<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="number">1</span>).cache().reduce(add)</span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>但注意不能对空数组进行 reduce</p>
<h3 id="takesample">takeSample()</h3>
<p>takeSample() 操作返回一个数组，其中包含来自数据集的随机元素样本。它接受一个 withReplacement 参数，它指定是否可以从父 RDD 中多次随机选择相同的项目（因此当 withReplacement=True 时，您可以多次取回相同的项目）。它还采用可选的种子参数，允许您为随机数生成器指定种子值，以便可以获得可重现的结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(filteredRDD.collect())</span><br><span class="line"><span class="comment"># takeSample reusing elements</span></span><br><span class="line">print(filteredRDD.takeSample(withReplacement=<span class="literal">True</span>, num=<span class="number">6</span>))</span><br><span class="line"><span class="comment"># takeSample without reuse</span></span><br><span class="line">print(filteredRDD.takeSample(withReplacement=<span class="literal">False</span>, num=<span class="number">6</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[3, 0, 7, 1, 7, 6]</span><br><span class="line">[7, 1, 5, 9, 0, 6]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set seed for predictability</span></span><br><span class="line">print(filteredRDD.takeSample(withReplacement=<span class="literal">False</span>, num=<span class="number">6</span>, seed=<span class="number">500</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[6, 4, 0, 1, 3, 5]</span><br></pre></td></tr></table></figure>
<h3 id="countbyvalue">countByValue()</h3>
<p>countByValue() 操作将 RDD 中每个唯一值的计数作为将值映射到计数的字典返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sorted</span>(sc.parallelize([<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>], <span class="number">2</span>).countByValue().items())</span><br><span class="line"><span class="comment"># [(1, 2), (2, 3)]</span></span><br></pre></td></tr></table></figure>
<h2 id="一些辅助的函数">一些辅助的函数</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 给 RDD 设置名字</span></span><br><span class="line">filteredRDD.setName(<span class="string">&#x27;My Filtered RDD&#x27;</span>)</span><br><span class="line"><span class="comment"># 缓存 RDD</span></span><br><span class="line">filteredRDD.cache()</span><br><span class="line"><span class="comment"># 查看当前 RDD 是否缓存了</span></span><br><span class="line">print(filteredRDD.is_cached)</span><br><span class="line"><span class="comment"># 使用完了 RDD，可以停止在内存中缓存它</span></span><br><span class="line">filteredRDD.unpersist()</span><br><span class="line"><span class="comment"># Storage level for a non cached RDD</span></span><br><span class="line">print(filteredRDD.getStorageLevel())</span><br><span class="line">filteredRDD.cache()</span><br><span class="line"><span class="comment"># Storage level for a cached RDD</span></span><br><span class="line">print(filteredRDD.getStorageLevel())</span><br><span class="line"><span class="comment"># Note that toDebugString also provides storage information</span></span><br><span class="line">print(filteredRDD.toDebugString())</span><br></pre></td></tr></table></figure>
<h2 id="引用参考资料">引用参考资料</h2>
<p>作者：孤影渡寒江 链接：https://juejin.cn/post/6844904147502759943 来源：稀土掘金 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Apache-Spark/" rel="tag"># Apache Spark</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/07/6afaeaedc357/" rel="prev" title="Different tkinter Frame style(relief)">
      <i class="fa fa-chevron-left"></i> Different tkinter Frame style(relief)
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#rdd%E8%BD%AC%E6%8D%A2%E6%93%8D%E4%BD%9Crdd-transformation"><span class="nav-number">1.</span> <span class="nav-text">RDD转换操作（RDD Transformation）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mapfunc"><span class="nav-number">1.1.</span> <span class="nav-text">map(func)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flatmap"><span class="nav-number">1.2.</span> <span class="nav-text">flatMap()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filterfunc"><span class="nav-number">1.3.</span> <span class="nav-text">filter(func)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#groupbykey"><span class="nav-number">1.4.</span> <span class="nav-text">groupByKey()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reducebykey"><span class="nav-number">1.5.</span> <span class="nav-text">reduceByKey()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#combinebykey"><span class="nav-number">1.6.</span> <span class="nav-text">combineByKey()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#foldbykey"><span class="nav-number">1.7.</span> <span class="nav-text">foldByKey()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rdd%E6%89%A7%E8%A1%8C%E6%93%8D%E4%BD%9Crdd-action"><span class="nav-number">2.</span> <span class="nav-text">RDD执行操作（RDD Action）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#count-%E8%BF%94%E5%9B%9E-rdd-%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E6%95%B0%E9%87%8F"><span class="nav-number">2.1.</span> <span class="nav-text">count() 返回 RDD 中的元素数量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#taken"><span class="nav-number">2.2.</span> <span class="nav-text">take(n)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#first"><span class="nav-number">2.3.</span> <span class="nav-text">first()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#takeordered"><span class="nav-number">2.4.</span> <span class="nav-text">takeOrdered()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#top"><span class="nav-number">2.5.</span> <span class="nav-text">top()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reduce"><span class="nav-number">2.6.</span> <span class="nav-text">reduce()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#takesample"><span class="nav-number">2.7.</span> <span class="nav-text">takeSample()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#countbyvalue"><span class="nav-number">2.8.</span> <span class="nav-text">countByValue()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E8%BE%85%E5%8A%A9%E7%9A%84%E5%87%BD%E6%95%B0"><span class="nav-number">3.</span> <span class="nav-text">一些辅助的函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E7%94%A8%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">4.</span> <span class="nav-text">引用参考资料</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Vincent Huang</p>
  <div class="site-description" itemprop="description">A student studying in New Zealand, majoring in computer science.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Vincent-Huang-2000" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Vincent-Huang-2000" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>简体中文</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="">
      
        <option value="zh-CN" data-href="/2023/03/12093ec9a984/" selected="">
          简体中文
        </option>
      
        <option value="en" data-href="/en/2023/03/12093ec9a984/" selected="">
          English
        </option>
      
    </select>
  </div>

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Vincent Huang</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">17k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">16 分钟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false}});</script></body>
</html>
